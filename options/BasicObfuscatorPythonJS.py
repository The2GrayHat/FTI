import base64;exec(base64.b64decode('aW1wb3J0IGFzdCwgcmFuZG9tLCBzdHJpbmcsIGJhc2U2NCwgb3MKCmNsYXNzIE9mdXNjYWRvckxvY2FsKGFzdC5Ob2RlVHJhbnNmb3JtZXIpOgoKICAgIGRlZiBfMHg2NzFkMTY0MihzZWxmKToKICAgICAgICByZXR1cm4gJ18weCcgKyAnJy5qb2luKHJhbmRvbS5jaG9pY2VzKHN0cmluZy5oZXhkaWdpdHMubG93ZXIoKSwgaz04KSkKCiAgICBkZWYgXzB4NmI5ZjdhZmEoc2VsZiwgbm9tYnJlc19sb2NhbGVzKToKICAgICAgICBzZWxmLm1hcHBpbmcgPSB7fQogICAgICAgIHNlbGYuZGVmaW5pZG9zX2FxdWkgPSBub21icmVzX2xvY2FsZXMKCiAgICBkZWYgXzB4ZmZlYjc2YWMoc2VsZiwgbm9kZSk6CiAgICAgICAgaWYgaGFzYXR0cihzZWxmLCAnZGVmaW5pZG9zX2FxdWknKSBhbmQgbm9kZS5pZCBpbiBzZWxmLmRlZmluaWRvc19hcXVpOgogICAgICAgICAgICBpZiBub2RlLmlkIG5vdCBpbiBzZWxmLm1hcHBpbmc6CiAgICAgICAgICAgICAgICBzZWxmLm1hcHBpbmdbbm9kZS5pZF0gPSBzZWxmLl9nZW4oKQogICAgICAgICAgICBub2RlLmlkID0gc2VsZi5tYXBwaW5nW25vZGUuaWRdCiAgICAgICAgcmV0dXJuIG5vZGUKCiAgICBkZWYgXzB4NGM0ZmQ5NmEoc2VsZiwgbm9kZSk6CiAgICAgICAgaWYgaGFzYXR0cihzZWxmLCAnZGVmaW5pZG9zX2FxdWknKSBhbmQgbm9kZS5uYW1lIGluIHNlbGYuZGVmaW5pZG9zX2FxdWk6CiAgICAgICAgICAgIGlmIG5vZGUubmFtZSBub3QgaW4gc2VsZi5tYXBwaW5nOgogICAgICAgICAgICAgICAgc2VsZi5tYXBwaW5nW25vZGUubmFtZV0gPSBzZWxmLl9nZW4oKQogICAgICAgICAgICBub2RlLm5hbWUgPSBzZWxmLm1hcHBpbmdbbm9kZS5uYW1lXQogICAgICAgIHNlbGYuZ2VuZXJpY192aXNpdChub2RlKQogICAgICAgIHJldHVybiBub2RlCgpkZWYgXzB4YzExMjcyYmUoY29kaWdvKToKICAgIF8weGRjOWI0ZWNhID0gc2V0KCkKICAgIHRyeToKICAgICAgICBfMHhmYmJjOTZlZSA9IGFzdC5wYXJzZShjb2RpZ28pCiAgICAgICAgZm9yIG5vZGUgaW4gYXN0LndhbGsoXzB4ZmJiYzk2ZWUpOgogICAgICAgICAgICBpZiBpc2luc3RhbmNlKG5vZGUsIGFzdC5GdW5jdGlvbkRlZik6CiAgICAgICAgICAgICAgICBfMHhkYzliNGVjYS5hZGQobm9kZS5uYW1lKQogICAgICAgICAgICBpZiBpc2luc3RhbmNlKG5vZGUsIGFzdC5Bc3NpZ24pOgogICAgICAgICAgICAgICAgZm9yIHRhcmdldCBpbiBub2RlLnRhcmdldHM6CiAgICAgICAgICAgICAgICAgICAgaWYgaXNpbnN0YW5jZSh0YXJnZXQsIGFzdC5OYW1lKToKICAgICAgICAgICAgICAgICAgICAgICAgXzB4ZGM5YjRlY2EuYWRkKHRhcmdldC5pZCkKICAgIGV4Y2VwdDoKICAgICAgICBwYXNzCiAgICBfMHhmZTNiYTA4ZiA9IHsncHJpbnQnLCAncmFuZ2UnLCAnbGVuJywgJ2lucHV0JywgJ2ludCcsICdzdHInLCAnbGlzdCcsICdkaWN0JywgJ29wZW4nLCAnZXhpdCcsICdzZWxmJywgJ3N5cycsICdvcyd9CiAgICByZXR1cm4gXzB4ZGM5YjRlY2EgLSBfMHhmZTNiYTA4ZgoKZGVmIF8weGJhMmVjZjYwKCk6CiAgICBwcmludCgnXG4nICsgJyDwn5uh77iPICBYU1B5IE9CRlVTQ0FUT1IgdjMgKEZpbmFsKSAnLmNlbnRlcig0NSwgJz0nKSkKICAgIF8weDhlMTFlZDU3ID0gaW5wdXQoJ1xu8J+TgiBSdXRhIGRlbCBhcmNoaXZvOiAnKS5zdHJpcCgpLnJlcGxhY2UoIiciLCAnJykucmVwbGFjZSgnIicsICcnKQogICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKF8weDhlMTFlZDU3KToKICAgICAgICByZXR1cm4gcHJpbnQoJ+KdjCBFcnJvcjogQXJjaGl2byBubyBlbmNvbnRyYWRvLicpCiAgICB3aXRoIG9wZW4oXzB4OGUxMWVkNTcsICdyJywgZW5jb2Rpbmc9J3V0Zi04JykgYXMgZjoKICAgICAgICBfMHg1MjA0NmIyZSA9IGYucmVhZCgpCiAgICBfMHhkYmNlY2UxNyA9IG9zLnBhdGguc3BsaXRleHQoXzB4OGUxMWVkNTcpWzFdLmxvd2VyKCkKICAgIGlmIF8weGRiY2VjZTE3ID09ICcucHknOgogICAgICAgIHRyeToKICAgICAgICAgICAgXzB4OTc5MWZkYTcgPSBfMHhjMTEyNzJiZShfMHg1MjA0NmIyZSkKICAgICAgICAgICAgXzB4ZmJiYzk2ZWUgPSBhc3QucGFyc2UoXzB4NTIwNDZiMmUpCiAgICAgICAgICAgIF8weDdjNWQ3Y2U5ID0gT2Z1c2NhZG9yTG9jYWwoKQogICAgICAgICAgICBfMHg3YzVkN2NlOS5jb25maWd1cmFyKF8weDk3OTFmZGE3KQogICAgICAgICAgICBfMHg2MDg0MzhhZCA9IF8weDdjNWQ3Y2U5LnZpc2l0KF8weGZiYmM5NmVlKQogICAgICAgICAgICBhc3QuZml4X21pc3NpbmdfbG9jYXRpb25zKF8weDYwODQzOGFkKQogICAgICAgICAgICBfMHg0MDZlYzQ4NSA9IGFzdC51bnBhcnNlKF8weDYwODQzOGFkKQogICAgICAgICAgICBfMHhjNDRkYjBiYyA9IGJhc2U2NC5iNjRlbmNvZGUoXzB4NDA2ZWM0ODUuZW5jb2RlKCkpLmRlY29kZSgpCiAgICAgICAgICAgIF8weGI1OWY2YzAzID0gZiJpbXBvcnQgYmFzZTY0O2V4ZWMoYmFzZTY0LmI2NGRlY29kZSgne18weGM0NGRiMGJjfScpKSIKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHJldHVybiBwcmludChmJ+KdjCBFcnJvciBpbnRlcm5vOiB7ZX0nKQogICAgZWxpZiBfMHhkYmNlY2UxNyA9PSAnLmpzJzoKICAgICAgICBfMHhjNDRkYjBiYyA9IGJhc2U2NC5iNjRlbmNvZGUoXzB4NTIwNDZiMmUuZW5jb2RlKCkpLmRlY29kZSgpCiAgICAgICAgXzB4YjU5ZjZjMDMgPSBmImV2YWwoQnVmZmVyLmZyb20oJ3tfMHhjNDRkYjBiY30nLCAnYmFzZTY0JykudG9TdHJpbmcoJ3V0Zi04JykpIgogICAgZWxzZToKICAgICAgICByZXR1cm4gcHJpbnQoJ+KaoO+4jyBTb2xvIC5weSBvIC5qcycpCiAgICBfMHhmOGNlYmJmNCA9IGYnb2Z1c2NhZG9fe29zLnBhdGguYmFzZW5hbWUoXzB4OGUxMWVkNTcpfScKICAgIHdpdGggb3BlbihfMHhmOGNlYmJmNCwgJ3cnLCBlbmNvZGluZz0ndXRmLTgnKSBhcyBmOgogICAgICAgIGYud3JpdGUoXzB4YjU5ZjZjMDMpCiAgICBwcmludChmJ1xu4pyFIFByb2Nlc28gdGVybWluYWRvLiBBcmNoaXZvOiB7XzB4ZjhjZWJiZjR9JykKaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKICAgIF8weGJhMmVjZjYwKCk='))